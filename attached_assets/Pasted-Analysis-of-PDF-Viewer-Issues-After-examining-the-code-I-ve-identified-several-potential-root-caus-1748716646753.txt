Analysis of PDF Viewer Issues
After examining the code, I've identified several potential root causes for the PDF viewer being stuck in loading state:

1. PDF.js Worker Configuration Issue
In /client/src/pages/admin/order-detail.tsx, the PDF.js worker is configured with:

pdfjs.GlobalWorkerOptions.workerSrc = `https://unpkg.com/pdfjs-dist@${pdfjs.version}/build/pdf.worker.min.js`;
This external CDN dependency might be:

Blocked by browser security policies
Failing to load due to network issues
Version mismatch between the installed package and CDN worker
2. CORS and Content Security Policy Issues
The server in /server/routes.ts sets headers that might conflict:

res.setHeader('Access-Control-Allow-Origin', '*');
res.setHeader('X-Frame-Options', 'SAMEORIGIN');
The X-Frame-Options: SAMEORIGIN might interfere with PDF.js rendering, especially if it's trying to create internal frames.

3. PDF URL Path Issues
The PDF URL is constructed as /api/orders/${orderId}/proof, but looking at the server route structure, there might be a mismatch between the expected endpoint and actual implementation.

4. Object Store Access Issues
From /server/routes.ts, the PDF retrieval depends on:

Valid order.eftPop field containing the object store key
Successful object store connection
Proper file buffer handling
5. React-PDF Version Compatibility
The component imports specific CSS files:

import 'react-pdf/dist/esm/Page/AnnotationLayer.css';
import 'react-pdf/dist/esm/Page/TextLayer.css';
These might not exist in the current version or have different paths.

6. Error Handling Masking Real Issues
The current error handling in the PDF viewer might be catching and hiding the actual error:

const onDocumentLoadError = (error: Error) => {
  console.error('PDF loading error:', error);
  setLoading(false);
  setError(`Failed to load PDF: ${error.message}`);
};
Proposed Solutions
1. Fix PDF.js Worker Configuration
Use a local worker instead of CDN:

Install the worker locally via npm
Configure it to use the local build
This eliminates external dependency issues
2. Improve Server Headers
Remove conflicting headers and ensure proper PDF serving:

Remove X-Frame-Options for PDF endpoints
Add proper Content-Security-Policy for PDF.js
Ensure CORS headers are correctly set
3. Add Better Error Diagnostics
Enhance error logging to capture the actual failure:

Log the exact PDF URL being requested
Log server-side object store errors
Add network request debugging
4. Implement Progressive Fallbacks
Add fallback mechanisms:

Direct blob URL creation from fetched PDF data
iframe fallback with proper error handling
Download link as final fallback
5. Verify Object Store Integration
Ensure the object store is properly configured and accessible:

Check if order.eftPop contains valid object keys
Verify object store permissions
Add logging for object store operations
6. Update PDF.js Configuration
Use modern PDF.js configuration with proper error handling:

Update to latest stable version
Use proper ES modules configuration
Add comprehensive error boundaries
The most likely root cause is the PDF.js worker configuration combined with potential object store access issues. The external CDN worker dependency is particularly problematic in sandboxed environments like Replit.